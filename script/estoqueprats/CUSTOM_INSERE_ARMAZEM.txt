SET TERM ^ ;

CREATE OR ALTER PROCEDURE CUSTOM_INSERE_ARMAZEN (
    FILIAL INTEGER,
    INDICADORTIPOESTOQUE INTEGER,
    LOCAL INTEGER)
AS
DECLARE VARIABLE VARESTOQUE NUMERIC(15,3);
DECLARE VARIABLE VARPRODUTO INTEGER;
BEGIN
    FOR
        SELECT ESTOQUE.PRODUTO, ESTOQUE.ESTOQUEATUAL
        FROM ESTOQUE
        WHERE ESTOQUE.FILIAL = :FILIAL
        INTO :VARPRODUTO, VARESTOQUE
    DO BEGIN
        INSERT INTO ARMAZENAMENTO (FILIAL, LOCAL, PRODUTO, QUANTIDADE, INDICADORTIPOESTOQUE)
                           VALUES (:FILIAL, :LOCAL, :VARPRODUTO, :VARESTOQUE, :INDICADORTIPOESTOQUE);
    END
END^

SET TERM ; ^

