SET TERM ^ ;

CREATE OR ALTER procedure cus_setnf (
    numero integer,
    serie varchar(5),
    filial integer,
    origem varchar(1),
    clifor varchar(18),
    emissao date,
    saida date,
    hora time,
    condicaopagamento integer,
    formapagamento integer,
    baseicms numeric(15,2),
    valoricms numeric(15,2),
    basesubstituicao numeric(15,2),
    valorsubstituicao numeric(15,2),
    totalproduto numeric(15,2),
    valorfrete numeric(15,2),
    valorseguro numeric(15,2),
    valorencargo numeric(15,2),
    valoripi numeric(15,2),
    percdesconto numeric(15,2),
    valordesconto numeric(15,2),
    total numeric(15,2),
    funcionario integer,
    contafrete varchar(1),
    placa varchar(8),
    ufplaca varchar(2),
    volume integer,
    especie varchar(60),
    lote varchar(60),
    pesobruto numeric(15,3),
    obs varchar(4096),
    cancelada varchar(1),
    impressa varchar(1),
    atualizada varchar(1),
    tabelapreco integer,
    pedido integer,
    entregue varchar(1),
    basefunrural numeric(15,2),
    valorfunrural numeric(15,2),
    baseipi numeric(15,2),
    baseiss numeric(15,2),
    valoriss numeric(15,2),
    tipocfop integer,
    impressao timestamp,
    comissao numeric(8,2),
    basepis numeric(15,2),
    valorpis numeric(15,2),
    basecofins numeric(15,2),
    valorcofins numeric(15,2),
    valorisento numeric(15,2),
    somar varchar(1),
    modelo varchar(3),
    valorii numeric(15,2),
    valorsimples numeric(15,2),
    inutilizada varchar(1),
    denegada varchar(1),
    totaldevolvido numeric(15,2),
    valorst numeric(15,2),
    valorfretefinal numeric(15,2),
    fretepago varchar(1),
    percvariacao numeric(8,2),
    basest numeric(15,2),
    servico varchar(1),
    valorressarcimentost numeric(15,2),
    valoradiantamento numeric(15,2),
    finalidade varchar(1),
    totalbruto numeric(15,2),
    valorirrf numeric(15,2),
    valoricmsdiferimento numeric(15,2),
    conferido varchar(1),
    devolvida varchar(1),
    valordescontosimples numeric(15,2),
    idnumero integer,
    idserie varchar(5),
    idfilial integer,
    idmodelo varchar(3),
    baseressarcimentost numeric(15,2),
    valortotaltributo numeric(15,2),
    ordemcompra varchar(15),
    indicadorpresenca integer,
    totalservico numeric(15,2),
    totalicmsdestino numeric(15,2),
    totaldifal numeric(15,2),
    totalpartilhaorigem numeric(15,2),
    totalpartilhadestino numeric(15,2),
    totalfcep numeric(15,2),
    totalbaseicmsinterestadual numeric(15,2),
    valorpublica numeric(15,2),
    basefcep numeric(15,2),
    baseicmsdesonerado numeric(15,2),
    valoricmsdesonerado numeric(15,2),
    totalfcpst numeric(15,2),
    totalipidevolvido numeric(15,2),
    tipocontafrete integer,
    totalfcpstret numeric(15,2),
    datacancelamento date,
    totalfcpufdest numeric(15,2),
    basefcpufdest numeric(15,2))
as
declare variable varclifor integer;
BEGIN
    TABELAPRECO = 10||:TABELAPRECO;
    SELECT FIRST 1 CLIFOR.CODIGO
    FROM CLIFOR
    WHERE CLIFOR.CNPJ = :CLIFOR
    ORDER BY ATIVO, FILIAL DESC
    INTO :VARCLIFOR;
    INSERT INTO NF
    (
        NUMERO,
        SERIE,
        FILIAL,
        ORIGEM,
        CLIFOR,
        EMISSAO,
        SAIDA,
        HORA,
        CONDICAOPAGAMENTO,
        FORMAPAGAMENTO,
        BASEICMS,
        VALORICMS,
        BASESUBSTITUICAO,
        VALORSUBSTITUICAO,
        TOTALPRODUTO,
        VALORFRETE,
        VALORSEGURO,
        VALORENCARGO,
        VALORIPI,
        PERCDESCONTO,
        VALORDESCONTO,
        TOTAL,
        FUNCIONARIO,
        CONTAFRETE,
        PLACA,
        UFPLACA,
        VOLUME,
        ESPECIE,
        LOTE,
        PESOBRUTO,
        OBS,
        CANCELADA,
        IMPRESSA,
        ATUALIZADA,
        TABELAPRECO,
        PEDIDO,
        ENTREGUE,
        BASEFUNRURAL,
        VALORFUNRURAL,
        BASEIPI,
        BASEISS,
        VALORISS,
        TIPOCFOP,
        IMPRESSAO,
        COMISSAO,
        BASEPIS,
        VALORPIS,
        BASECOFINS,
        VALORCOFINS,
        VALORISENTO,
        SOMAR,
        MODELO,
        VALORII,
        VALORSIMPLES,
        INUTILIZADA,
        DENEGADA,
        TOTALDEVOLVIDO,
        VALORST,
        VALORFRETEFINAL,
        FRETEPAGO,
        PERCVARIACAO,
        BASEST,
        SERVICO,
        VALORRESSARCIMENTOST,
        VALORADIANTAMENTO,
        FINALIDADE,
        TOTALBRUTO,
        VALORIRRF,
        VALORICMSDIFERIMENTO,
        CONFERIDO,
        DEVOLVIDA,
        VALORDESCONTOSIMPLES,
        IDNUMERO,
        IDSERIE,
        IDFILIAL,
        IDMODELO,
        BASERESSARCIMENTOST,
        VALORTOTALTRIBUTO,
        ORDEMCOMPRA,
        INDICADORPRESENCA,
        TOTALSERVICO,
        TOTALICMSDESTINO,
        TOTALDIFAL,
        TOTALPARTILHAORIGEM,
        TOTALPARTILHADESTINO,
        TOTALFCEP,
        TOTALBASEICMSINTERESTADUAL,
        VALORPUBLICA,
        BASEFCEP,
        BASEICMSDESONERADO,
        VALORICMSDESONERADO,
        TOTALFCPST,
        TOTALIPIDEVOLVIDO,
        TIPOCONTAFRETE, 
        TOTALFCPSTRET,
        DATACANCELAMENTO,
        TOTALFCPUFDEST,
        BASEFCPUFDEST
    ) VALUES
    (
        :NUMERO,
        :SERIE,
        :FILIAL,
        :ORIGEM,
        :VARCLIFOR,
        :EMISSAO,
        :SAIDA,
        :HORA,
        :CONDICAOPAGAMENTO,
        :FORMAPAGAMENTO,
        :BASEICMS,
        :VALORICMS,
        :BASESUBSTITUICAO,
        :VALORSUBSTITUICAO,
        :TOTALPRODUTO,
        :VALORFRETE,
        :VALORSEGURO,
        :VALORENCARGO,
        :VALORIPI,
        :PERCDESCONTO,
        :VALORDESCONTO,
        :TOTAL,
        :FUNCIONARIO,
        :CONTAFRETE,
        :PLACA,
        :UFPLACA,
        :VOLUME,
        :ESPECIE,
        :LOTE,
        :PESOBRUTO,
        :OBS,
        :CANCELADA,
        :IMPRESSA,
        :ATUALIZADA,
        :TABELAPRECO,
        :PEDIDO,
        :ENTREGUE,
        :BASEFUNRURAL,
        :VALORFUNRURAL,
        :BASEIPI,
        :BASEISS,
        :VALORISS,
        :TIPOCFOP,
        :IMPRESSAO,
        :COMISSAO,
        :BASEPIS,
        :VALORPIS,
        :BASECOFINS,
        :VALORCOFINS,
        :VALORISENTO,
        :SOMAR,
        :MODELO,
        :VALORII,
        :VALORSIMPLES,
        :INUTILIZADA,
        :DENEGADA,
        :TOTALDEVOLVIDO,
        :VALORST,
        :VALORFRETEFINAL,
        :FRETEPAGO,
        :PERCVARIACAO,
        :BASEST,
        :SERVICO,
        :VALORRESSARCIMENTOST,
        :VALORADIANTAMENTO,
        :FINALIDADE,
        :TOTALBRUTO,
        :VALORIRRF,
        :VALORICMSDIFERIMENTO,
        :CONFERIDO,
        :DEVOLVIDA,
        :VALORDESCONTOSIMPLES,
        :IDNUMERO,
        :IDSERIE,
        :IDFILIAL,
        :IDMODELO,
        :BASERESSARCIMENTOST,
        :VALORTOTALTRIBUTO,
        :ORDEMCOMPRA,
        :INDICADORPRESENCA,
        :TOTALSERVICO,
        :TOTALICMSDESTINO,
        :TOTALDIFAL,
        :TOTALPARTILHAORIGEM,
        :TOTALPARTILHADESTINO,
        :TOTALFCEP,
        :TOTALBASEICMSINTERESTADUAL,
        :VALORPUBLICA,
        :BASEFCEP,
        :BASEICMSDESONERADO,
        :VALORICMSDESONERADO,
        :TOTALFCPST,
        :TOTALIPIDEVOLVIDO,
        :TIPOCONTAFRETE, 
        :TOTALFCPSTRET,
        :DATACANCELAMENTO,
        :TOTALFCPUFDEST,
        :BASEFCPUFDEST
    );
        
END^

SET TERM ; ^

