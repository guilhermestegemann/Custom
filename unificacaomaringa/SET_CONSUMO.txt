SET TERM ^ ;

CREATE OR ALTER procedure cus_setconsumo (
    filial integer,
    tipo varchar(2),
    documento integer,
    produto integer,
    data date,
    qtde numeric(15,3),
    unitario numeric(15,6),
    valordesconto float,
    custo numeric(15,6),
    despesa numeric(8,2),
    clifor varchar(18),
    vendedor integer,
    comissao numeric(15,4),
    qtdedevolvido numeric(15,3),
    valorvenda numeric(15,6),
    flex float,
    gerarflex varchar(1),
    tabelapreco integer,
    qtdecompra integer,
    pesoliquido numeric(15,3),
    pesobruto numeric(15,3),
    populacao integer,
    custotabela numeric(15,6),
    formapagamento integer,
    condicaopagamento integer,
    comissaoentrega numeric(15,4),
    pontos numeric(8,2),
    comissaoliberada varchar(1),
    datacomissaoliberada date,
    comissaopaga varchar(1),
    estado integer,
    custoreal numeric(15,6),
    populacaobairro integer,
    valoricms numeric(15,2),
    valoripi numeric(15,2),
    valorpis numeric(15,2),
    valorcofins numeric(15,2),
    encargo numeric(8,2),
    cnpjvalido varchar(1),
    valormarketing numeric(15,3),
    rapel numeric(8,2),
    datadevolvido date,
    rapelcomporcalculolucro varchar(1),
    rota integer,
    custotabelamedio numeric(15,6))
as
declare variable varclifor integer;
BEGIN
    TABELAPRECO = 10||:TABELAPRECO;
    ROTA = NULL;
    SELECT FIRST 1 CLIFOR.CODIGO
    FROM CLIFOR
    WHERE CLIFOR.CNPJ = :CLIFOR
    ORDER BY ATIVO, FILIAL DESC
    INTO :VARCLIFOR;

    INSERT INTO CONSUMO
    (
        FILIAL,
        TIPO,
        DOCUMENTO,
        PRODUTO,
        DATA,
        QTDE,
        UNITARIO,
        VALORDESCONTO,
        CUSTO,
        DESPESA,
        CLIFOR,
        VENDEDOR,
        COMISSAO,
        QTDEDEVOLVIDO,
        VALORVENDA,
        FLEX,
        GERARFLEX,
        TABELAPRECO,
        QTDECOMPRA,
        PESOLIQUIDO,
        PESOBRUTO,
        POPULACAO,
        CUSTOTABELA,
        FORMAPAGAMENTO,
        CONDICAOPAGAMENTO,
        COMISSAOENTREGA,
        PONTOS,
        COMISSAOLIBERADA,
        DATACOMISSAOLIBERADA,
        COMISSAOPAGA,
        ESTADO,
        CUSTOREAL,
        POPULACAOBAIRRO,
        VALORICMS,
        VALORIPI,
        VALORPIS,
        VALORCOFINS,
        ENCARGO,
        CNPJVALIDO,
        VALORMARKETING,
        RAPEL,
        DATADEVOLVIDO,
        RAPELCOMPORCALCULOLUCRO,
        ROTA,
        CUSTOTABELAMEDIO
    ) VALUES
    (
        :FILIAL,
        :TIPO,
        :DOCUMENTO,
        :PRODUTO,
        :DATA,
        :QTDE,
        :UNITARIO,
        :VALORDESCONTO,
        :CUSTO,
        :DESPESA,
        :VARCLIFOR,
        :VENDEDOR,
        :COMISSAO,
        :QTDEDEVOLVIDO,
        :VALORVENDA,
        :FLEX,
        :GERARFLEX,
        :TABELAPRECO,
        :QTDECOMPRA,
        :PESOLIQUIDO,
        :PESOBRUTO,
        :POPULACAO,
        :CUSTOTABELA,
        :FORMAPAGAMENTO,
        :CONDICAOPAGAMENTO,
        :COMISSAOENTREGA,
        :PONTOS,
        :COMISSAOLIBERADA,
        :DATACOMISSAOLIBERADA,
        :COMISSAOPAGA,
        :ESTADO,
        :CUSTOREAL,
        :POPULACAOBAIRRO,
        :VALORICMS,
        :VALORIPI,
        :VALORPIS,
        :VALORCOFINS,
        :ENCARGO,
        :CNPJVALIDO,
        :VALORMARKETING,
        :RAPEL,
        :DATADEVOLVIDO,
        :RAPELCOMPORCALCULOLUCRO,
        :ROTA,
        :CUSTOTABELAMEDIO
    );

END^

SET TERM ; ^

